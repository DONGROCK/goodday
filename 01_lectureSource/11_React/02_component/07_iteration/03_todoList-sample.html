<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>

        <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
        <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
        <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
        <style>
            body {
                margin: 0;
            }

            .container {
                background: skyblue;
                width: 100%;
                height: 100vh; /* 1vh는 화면의 높이 1% */
                display: flex;
                flex-direction: column;
            }

            .header {
                width: 100%;
                height: 100px;
                background: black;
                color: white;
                display: flex;
                justify-content: center;
                align-items: center;
                flex-direction: column;
            }

            .content {
                flex-grow: 1;
                background: lightgray;
                display: flex;
                justify-content: center;
                align-items: center;
                flex-direction: column;
            }

            .todo-list {
                background: white;
                width: 500px;
                border: 1px solid black;
                height: 500px;
                display: flex;
                flex-direction: column;
                align-items: flex-start;
                padding-left: 50px;
            }

            .todo-list label {
                margin: 20px;
            }

            .todo-list button {
                border: none;
                background: red;
                border-radius: 10px;
                color: white;
            }

            .append-list button {
                background: green;
                color: white;
                border: none;
                border-radius: 5px;
                height: 30px;
            }

            .footer {
                width: 100%;
                height: 100px;
                display: flex;
                background: black;
                color: white;
                justify-content: center;
                align-items: center;
                flex-direction: column;
            }
        </style>
    </head>

    <body>
        <div id="root"></div>

        <script type="text/babel">
            //선언
            const {useState} = React;

            function Header() {

                const [date, setDate] = useState(new Date());


                return (
                    <div className="Header">
                        <h1>오늘의 할일!{date.toDateString()}</h1>
                        
                    </div>
                );
            }
                    //자식
            function TodoItems({ todos, setTodos }) {
                // 리스트값, 변경을 위한 함수도 전달받음
                    
                    console.log("todo@@@@@@@@@@@@@@@@@@@@@@@",todos);
                    
                    //이 이벤트의 기능은 체크박스를 클릭했을 시 클릭한 체크박스의 id값과 작성된 id값이 일치하면
                    //해당todo.의 isDone 값이 업데이트 되는 것이다.
                    const onChangeHandler = (e) => {
                        const changeIsDoneList = todos.map((todo) =>{
                            if(todo.id === parseInt(e.target.id)){
                                todo.isDone = e.target.checked
                            }
                            return todo;
                        })
                        setTodos(changeIsDoneList);
                    }
                        //리무브 이벤트 호출 시 선택한 id값과 일치하지 않는 id값들만 업데이트한다.
                        //(선택한 id값은 삭제되고 나머지는 그대로 있는다)
                    const removeTodo = (id) => {
                        const removedList = todos.filter((todo) => todo.id !== id)
                        setTodos(removedList)
                    }

                    // const removeAllTodos = () => {
                    //     setTodos([]); // 비어있는 배열로 업데이트
                    // }


                    //체크박스id에 todo.id를 넣어줌으로 이벤트를 호출했을 때 
                    //isDone 값이 업데이트 된다.
                    //isDone의 값에 따라 목록에 라인을 주거나 주지않는다.
                return (
                    <>
                            {todos.map(todo => (
                                <p key={todo.id}>
                                    <input type='checkbox' id={todo.id} onChange={onChangeHandler}/>
                                    <label
                                        htmlFor={todo.id}
                                        // isDone의 상태가 true라면 목록에 라인을 준다.
                                        style={{textDecoration: todo.isDone ? 'line-through':'none'}}
                                    >
                                    {todo.desciption}
                                    </label>
                                    <button onClick={() => removeTodo(todo.id)}>x</button>
                                    
                                </p>
                                
                            ))}
                    </>
                );
                // return (
                //     <>
                //         {todos.map((todo, index) =>(
                //             <p key={index}>
                //                 <input type='chackbox' checked={todo.completed} onChange={() => {}}/>
                //                 <label>{todo.text}</label>
                //                 <button>x</button>
                //             </p>
                            
                //             ))}
                //     </>
                // );
            }

            // const todos = ['샤워하기','학원가기'];



                //부모
            function TodoList() {       //큰 껍데기 아이템발사대
                       //값 //수정할 메소드기능
                const [todos, setTodos] = useState([
                    {id:1, desciption: '할일 목록을 추가할 것', isDone: false}
                    ]);

                const [inputText, setInputText] = useState('')
                // id는 2번부터 시작한다.
                const [nextId, setNextId] = useState(2);
                    // 온체인지핸들러 호출 시 입력된 값이 텍스트입력창에 업데이트된다.
                const onChangeHandler = (e) =>{
                    setInputText(e.target.value)
                }
                    // 온클릭핸들러 호출 시 todos 속성값 id, desciption, isDone이 합쳐진 새로운 배열 생성
                    // 그배열을 changeTodos에 업데이트 함
                    
                const onClickHandler = () => {
                    
                    const changeTodos = todos.concat({
                        id: nextId,
                        desciption: inputText,
                        isDone: false,
                    })

                    // 텍스트입력창은 빈문자열이되고
                    // id는 1이 추가되서 업데이트
                    // 합쳐진 배열을 업데이트 한다.
                    setInputText('')
                    setNextId(nextId + 1)
                    setTodos(changeTodos)
                    console.log("changeTodos",changeTodos);
                    

                }
                return (
                    <>
                        <h3>ToDo-List</h3>
                        <div className='todo-list'>
                            <TodoItems todos={todos} setTodos={setTodos} />
                            {/*반복할 객체를 넘겨주고 출력하는 용도의 Component*/}
                        </div>
                        <div className='append-list'>
                            {/*todoList의 상태값을 변경하는 용도*/}
                            <input type='text' value={inputText} onChange={onChangeHandler} />
                            <button onClick={onClickHandler}>추가하기</button>
                           
                           
                        </div>
                    </>
                );
            }

            function Content() {
                return (
                    <div className='context'>
                        <TodoList />
                    </div>
                );
            }

            function Footer() {
                return (
                    <div className='footer'>
                        <p>Copyright 2022. team-greedy all rights reserved.</p>
                    </div>
                );
            }

            function TodoApp() {
                return (
                    <div className='container'>
                        <Header />
                        <Content />
                        <Footer />
                    </div>
                );
            }

            ReactDOM.createRoot(document.getElementById('root')).render(<TodoApp />);
        </script>
    </body>
</html>